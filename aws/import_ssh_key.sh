#!/bin/bash


##############################################################################
##############################################################################
##
## MAGIC NUMBERS
##
##############################################################################
##############################################################################


ARG_NUMBER=2


##############################################################################
##############################################################################
##
## USAGE
##
##############################################################################
##############################################################################


usage(){
    if [ $# -lt $ARG_NUMBER ]; then
        echo "Usage: "
        echo "$0 \ "
        echo "  --key-name [Name of the resulting SSH Key] \ "
        exit 1
    fi
}


##############################################################################
##############################################################################
##
## PARSE ARGS
##
##############################################################################
##############################################################################


parse_args(){
    while [[ $# > 1 ]];
    do
        key="$1"

        case $key in
            --key-name)
            KEY_NAME="$2"
            shift # past argument
            ;;
            --user-id)
            USER_ID="$2"
            shift # past argument
            ;;
            *)
            # unknown option
            ;;
        esac
        shift
    done
}

##############################################################################
##############################################################################
##
## MAIN
##
##############################################################################
##############################################################################


main(){

    ssh-keygen -t rsa -C ${USER_ID} -f ~/.ssh/${KEY_NAME}
    aws ec2 import-key-pair --key-name ${KEY_NAME} --public-key-material fileb://~/.ssh/${KEY_NAME}.pub --region 'us-east-1'

}


usage $@
parse_args $@

main

